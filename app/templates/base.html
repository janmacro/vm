<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or "VM Optimizer" }}</title>
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js"
    integrity="sha384-ZBXiYtYQ6hJ2Y0ZNoYuI+Nq5MqWBr+chMrS/RkXpNzQCApHEhOt2aY8EJgqwHLkJ"
    crossorigin="anonymous"
  ></script>
  {% block extra_head %}{% endblock %}
</head>
<body class="min-h-screen bg-slate-100 text-slate-900">
  <div class="mx-auto flex w-full max-w-5xl flex-col gap-6 p-6">
    <header class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
      <h1 class="text-3xl font-semibold">üèä VM Optimizer</h1>
      <nav class="flex items-center gap-2 text-sm font-medium text-slate-600">
        {% set current_endpoint = request.endpoint or '' %}
        {% if current_user.is_authenticated %}
          <span class="px-2 text-slate-500">{{ current_user.email }}</span>
          <a
            class="rounded px-3 py-1 hover:bg-slate-200"
            href="{{ url_for('auth.logout') }}"
          >
            Logout
          </a>
        {% endif %}
      </nav>
    </header>
    <main hx-boost="true">
      {% block content %}{% endblock %}
    </main>
  </div>
  <script>
    // Attach CSRF token to all HTMX requests
    document.addEventListener('htmx:configRequest', function (event) {
      var tokenTag = document.querySelector('meta[name="csrf-token"]');
      if (tokenTag) {
        event.detail.headers['X-CSRFToken'] = tokenTag.getAttribute('content');
      }
    });
  </script>
  {% block extra_scripts %}{% endblock %}
</body>
</html>
